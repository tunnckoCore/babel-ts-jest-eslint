{
  "/home/charlike/code/babel-ts-jest-eslint/src/add.ts": {
    "path": "/home/charlike/code/babel-ts-jest-eslint/src/add.ts",
    "contents": "export const plus = (a: number, b: number) => a + b;\n\n// some okxx\nexport const minus = (a: number, b: number) => a - b;\n",
    "contentHash": "6867b04b7d71033f20afede4085c6746be244da36146cafb960f285572024911",
    "stat": {
      "dev": 2055,
      "mode": 33188,
      "nlink": 1,
      "uid": 1000,
      "gid": 1000,
      "rdev": 0,
      "blksize": 4096,
      "ino": 5901758,
      "size": 121,
      "blocks": 8,
      "atimeMs": 1547275699160.6687,
      "mtimeMs": 1547275698900.6687,
      "ctimeMs": 1547275698900.6687,
      "birthtimeMs": 1547275698900.6687
    }
  },
  "/home/charlike/code/babel-ts-jest-eslint/src/bar.ts": {
    "path": "/home/charlike/code/babel-ts-jest-eslint/src/bar.ts",
    "contents": "// import fs from 'fs-extra';\n// import fastGlob from 'fast-glob';\n\n// // class GlobStateCache {\n// //   async load(stateFile) {\n// //     let state = null;\n// //     if (fs.existsSync(stateFile)) {\n// //       const rawState = await fs.readFile(stateFile);\n// //       state = JSON.parse(rawState);\n// //     } else {\n// //       await fs.writeFile(stateFile, '{}');\n// //       state = {};\n// //     }\n// //     this.state = state;\n// //   }\n\n// //   async monitor(patterns) {\n// //     await fastGlob(patterns, {\n// //       ignore: ['**/node_modules/**'],\n// //       transform: async (fp) => {\n// //         const file = { path: fp };\n\n// //         file.contents = fs.readFile(file.path, 'utf8');\n// //       },\n// //     });\n// //   }\n// // }\n\n// async function main() {\n//   await fastGlob('.', {\n//     ignore: ['**/node_modules/**'],\n//     transform: async (fp) => {\n//       const file = { path: fp, contents: await fs.readFile(fp, 'utf8') };\n//       console.log(file);\n//       return file;\n//     },\n//   });\n// }\n\n// main();\n",
    "contentHash": "868ea37a20ba643e184282055b2167551b570ad8fa1377a69b09f1138b0f15e6",
    "stat": {
      "dev": 2055,
      "mode": 33188,
      "nlink": 1,
      "uid": 1000,
      "gid": 1000,
      "rdev": 0,
      "blksize": 4096,
      "ino": 5901073,
      "size": 1041,
      "blocks": 8,
      "atimeMs": 1547267468650.5942,
      "mtimeMs": 1547267468360.5942,
      "ctimeMs": 1547267468360.5942,
      "birthtimeMs": 1547267468360.5942
    }
  },
  "/home/charlike/code/babel-ts-jest-eslint/src/glob-cache.js": {
    "path": "/home/charlike/code/babel-ts-jest-eslint/src/glob-cache.js",
    "contents": "import fs from 'fs-extra';\nimport crypto from 'crypto';\nimport fastGlob from 'fast-glob';\n\n/* eslint-disable class-methods-use-this */\n\nclass GlobStateCache {\n  constructor() {\n    this.loadedFiles = null;\n    this.changedFiles = {};\n  }\n\n  async loadCache(stateFile) {\n    this.stateFile = stateFile;\n\n    if (fs.existsSync(this.stateFile)) {\n      const rawState = await fs.readFile(this.stateFile, 'utf8');\n\n      this.loadedFiles = JSON.parse(rawState);\n    }\n\n    return this;\n  }\n\n  // allow passing option for maintaining clean state?\n  // now it can be called \"dirty\" because\n  // it never cleans up after, for example, (re)moving a file from the system\n  // the entry for this file stays, which is very aggresive but why not?\n  async monitor(patterns, options) {\n    const opts = Object.assign(\n      { ignore: ['**/{node_modules,coverage,dist}/**'] },\n      options,\n      { onlyFiles: true, absolute: true },\n    );\n\n    // compare(oldFileFromCache: object, newFile: object): boolean\n    let { shouldChange, onChange } = opts;\n    shouldChange =\n      typeof shouldChange === 'function'\n        ? shouldChange\n        : (oldFile, file) => {\n            const differentSize = file.stat.size !== oldFile.stat.size;\n            const differentContents = file.contentHash !== oldFile.contentHash;\n            const modifiedTime = file.stat.mtimeMs !== oldFile.stat.mtimeMs;\n\n            return differentSize && differentContents && modifiedTime;\n          };\n\n    onChange = typeof onChange === 'function' ? onChange : () => {};\n\n    const filepaths = await fastGlob(patterns, opts);\n\n    /* eslint-disable no-restricted-syntax, no-await-in-loop */\n\n    if (!this.loadedFiles) {\n      for (const filepath of filepaths) {\n        const file = await this.createFile(filepath);\n        this.changedFiles[file.path] = file;\n      }\n\n      return this.changedFiles;\n    }\n\n    for (const filepath of filepaths) {\n      const loadedFile = this.loadedFiles[filepath];\n      const file = await this.createFile(filepath);\n\n      if (loadedFile) {\n        if (shouldChange(loadedFile, file)) {\n          onChange(loadedFile, file);\n          this.changedFiles[file.path] = file;\n        }\n      } else {\n        this.changedFiles[file.path] = file;\n      }\n    }\n\n    return this.changedFiles;\n  }\n\n  async writeCache(changed) {\n    const state = Object.assign(\n      {},\n      this.loadedFiles,\n      this.changedFiles,\n      changed,\n    );\n\n    await fs.writeFile(this.stateFile, JSON.stringify(state, null, 2));\n  }\n\n  async createFile(file) {\n    const res = {};\n    let stat = null;\n\n    if (file && typeof file === 'object') {\n      stat = file.stat || (await fs.lstat(file.path));\n      res.path = file.path;\n      res.contents = file.contents || (await fs.readFile(file.path, 'utf8'));\n    } else {\n      stat = await fs.lstat(file);\n      res.path = file;\n      res.contents = await fs.readFile(file, 'utf8');\n    }\n\n    res.contentHash = crypto\n      .createHash('sha256')\n      .update(res.contents)\n      .digest('hex');\n\n    res.stat = Object.keys(stat).reduce((acc, key) => {\n      // all (including `atimeMs`, `mtimeMs` and `ctimeMs`)\n      // but except the Date objects like `atime`, `mtime` and `ctime`\n      if (!key.endsWith('time')) {\n        acc[key] = stat[key];\n      }\n      return acc;\n    }, {});\n\n    return res;\n  }\n}\n\nasync function main(patterns, options) {\n  const globState = new GlobStateCache();\n\n  await globState.loadCache('./file-cache.json');\n\n  // only the changed files\n  // from the given glob patterns\n  const changedFiles = await globState.monitor(patterns, options);\n  console.log(changedFiles);\n  console.log('Changed:', Object.keys(changedFiles).length);\n\n  // later, write save the cache\n  await globState.writeCache();\n\n  return globState;\n}\n\nmain(['src/**/*.{js,ts,tsx}', '!src/**/*.test.{ts,tsx}'], {\n  /**\n   * Defaults to the following `opts.shouldChange`\n   *\n   * @params {Object} oldFile - file from cache\n   * @params {Object} file - current state of the file\n   */\n  // shouldChange: (oldFile, file) => {\n  //   const differentSize = file.stat.size !== oldFile.stat.size;\n  //   const differentContents = file.contentHash !== oldFile.contentHash;\n  //   const modifiedTime = file.stat.mtimeMs !== oldFile.stat.mtimeMs;\n\n  //   return differentSize && differentContents && modifiedTime;\n  // },\n\n  /**\n   * Called when `opts.shouldChange` returns `true`\n   *\n   * @params {Object} oldFile - file from cache\n   * @params {Object} file - current state of the file\n   */\n  onChange: (oldFile, file) => {\n    console.log(oldFile.contentHash !== file.contentHash); // true\n  },\n});\n",
    "contentHash": "71ffcf6d11276e665584735b826fc02f4f75d138f27efdbbf8fcfac6bb03fcd7",
    "stat": {
      "dev": 2055,
      "mode": 33188,
      "nlink": 1,
      "uid": 1000,
      "gid": 1000,
      "rdev": 0,
      "blksize": 4096,
      "ino": 5901079,
      "size": 4632,
      "blocks": 16,
      "atimeMs": 1547277843980.6882,
      "mtimeMs": 1547277843700.6882,
      "ctimeMs": 1547277843700.6882,
      "birthtimeMs": 1547277843700.6882
    }
  },
  "/home/charlike/code/babel-ts-jest-eslint/src/hoho.js": {
    "path": "/home/charlike/code/babel-ts-jest-eslint/src/hoho.js",
    "contents": "const ok = 1111111111;\n",
    "contentHash": "51c57519ffb21b5791aaa72a2bf615438a94955e56761d69da176cd24e51ce5d",
    "stat": {
      "dev": 2055,
      "mode": 33188,
      "nlink": 1,
      "uid": 1000,
      "gid": 1000,
      "rdev": 0,
      "blksize": 4096,
      "ino": 5901085,
      "size": 23,
      "blocks": 8,
      "atimeMs": 1547270097850.618,
      "mtimeMs": 1547269790260.6152,
      "ctimeMs": 1547270093170.618,
      "birthtimeMs": 1547270093170.618
    }
  }
}